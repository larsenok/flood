# Flood Control Engineer

A daily browser puzzle where water pushes in from the map boundary and rivers, and you place limited levees to save the largest dry area and protect key districts.

## Tech
- TypeScript
- HTML5 Canvas (single canvas)
- Vite
- Supabase (leaderboard via REST)

## Run locally
```bash
npm install
npm run dev
```

## Build
```bash
npm run build
```

Vite outputs production files to `dist/`, which can be deployed directly to Vercel as a static site.

## Controls
- Click / tap land tile: place/remove levee
- You **cannot** place levees on HOME or HOSPITAL tiles
- **R**: restart
- **Z**: undo
- **N**: new daily level
- **L**: toggle leaderboard

Top bar shows level date, placements remaining, score, and flood coverage percent.

## Leaderboard setup (Supabase)

### 1) Add environment secrets
Create a local `.env` file (or add these in your hosting provider secret settings):

```bash
VITE_SUPABASE_URL=https://YOUR_PROJECT_REF.supabase.co
VITE_SUPABASE_ANON_KEY=YOUR_SUPABASE_ANON_KEY
```

> Never commit real keys to git. Keep production values in your deployment platform's environment variables.

### 2) SQL for leaderboard table
Run this in Supabase SQL editor:

```sql
create table if not exists public.flood_leaderboard (
  id bigint generated by default as identity primary key,
  nickname text not null default 'ANON',
  level_date text not null,
  score integer not null,
  flooded_pct integer not null,
  bags_used integer not null,
  wall_budget integer not null,
  dry_land integer not null,
  flooded_tiles integer not null,
  total_tiles integer not null,
  time_spent_ms integer not null,
  created_at timestamptz not null default now()
);

alter table public.flood_leaderboard enable row level security;

create policy "Allow insert for anon" on public.flood_leaderboard
for insert to anon
with check (true);

create policy "Allow read for anon" on public.flood_leaderboard
for select to anon
using (true);
```

## Score submit flow
- Once a HOME is contained, a **Submit score** button appears near the bottom.
- Clicking it asks for a 3-letter nickname.
- Blank nickname submits as `ANON`.
- Time spent is measured from your first placed sandbag until submit.
- After submit, you can open the side leaderboard panel.
